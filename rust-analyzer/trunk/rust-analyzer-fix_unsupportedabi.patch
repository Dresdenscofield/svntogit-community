From 84837229b441cee84391f5f26594f9642b439208 Mon Sep 17 00:00:00 2001
From: Akatsuki Rui <3736910+akiirui@users.noreply.github.com>
Date: Tue, 15 Nov 2022 01:18:25 +0800
Subject: [PATCH] fix: UnsupportedABI on Arch Linux

---
 crates/rust-analyzer/src/cli/load_cargo.rs | 2 +-
 crates/rust-analyzer/src/reload.rs         | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/crates/rust-analyzer/src/cli/load_cargo.rs b/crates/rust-analyzer/src/cli/load_cargo.rs
index 5dba545b8..befaeb9e7 100644
--- a/crates/rust-analyzer/src/cli/load_cargo.rs
+++ b/crates/rust-analyzer/src/cli/load_cargo.rs
@@ -69,7 +69,7 @@ pub fn load_workspace(
             if let Some(sysroot) = sysroot.as_ref() {
                 let standalone_server_name =
                     format!("rust-analyzer-proc-macro-srv{}", std::env::consts::EXE_SUFFIX);
-                let server_path = sysroot.root().join("libexec").join(&standalone_server_name);
+                let server_path = sysroot.root().join("lib").join(&standalone_server_name);
                 if std::fs::metadata(&server_path).is_ok() {
                     path = server_path;
                     args = vec![];
diff --git a/crates/rust-analyzer/src/reload.rs b/crates/rust-analyzer/src/reload.rs
index aa0510a4e..097684295 100644
--- a/crates/rust-analyzer/src/reload.rs
+++ b/crates/rust-analyzer/src/reload.rs
@@ -329,7 +329,7 @@ impl GlobalState {
                                 if let Some(sysroot) = sysroot.as_ref() {
                                     let server_path = sysroot
                                         .root()
-                                        .join("libexec")
+                                        .join("lib")
                                         .join(&standalone_server_name);
                                     if std::fs::metadata(&server_path).is_ok() {
                                         tracing::debug!(
-- 
2.38.1

