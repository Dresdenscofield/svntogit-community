# Maintainer: Felix Yan <felixonmars@archlinux.org>

pkgname=deepin-voice-note
pkgver=5.10.17
pkgrel=1
pkgdesc='A lightweight memo tool to make text notes and voice recordings'
arch=('x86_64')
url="https://github.com/linuxdeepin/deepin-voice-note"
license=('GPL3')
replaces=('deepin-voice-recorder')
depends=('deepin-qt5integration' 'qt5-webengine' 'vlc')
makedepends=('cmake' 'gmock' 'gtest' 'ninja' 'qt5-tools')
groups=('deepin-extra')
source=("https://github.com/linuxdeepin/deepin-voice-note/archive/$pkgver/$pkgname-$pkgver.tar.gz"
        $pkgname-fix-flags.patch::https://github.com/linuxdeepin/deepin-voice-note/pull/54.patch)
sha512sums=('60070fe3fcb2f03457e6df8aca8add4e2a7e9831f995e6130a33891958582d24b134839aa1d6efe791b5dfbf9c8947c63944c34344d4bdbfbba778858b88e3f0'
            '2ba9f4774a6485eb563dfe3b5f9df9d58e4c6208b752459a31b9979f3e2c2d4a6f551c244a13983873490358520c41ec331c54ba1e46d65f162f49efb86914e8')

prepare() {
  cd deepin-voice-note-$pkgver
  patch -p1 -i ../$pkgname-fix-flags.patch
}

build() {
  cd deepin-voice-note-$pkgver
  cmake -GNinja .
  ninja
}

check() {
  cd deepin-voice-note-$pkgver
  ninja test || :
}

package() {
  cd deepin-voice-note-$pkgver
  DESTDIR="$pkgdir" ninja install
}
